!function(a){var b=!!~navigator.userAgent.indexOf(" AppleWebKit/");a.fn.console=function(c){function A(){o=0,p="",u=0,T(),l=a('<div class="jquery-console-prompt-box"></div>');var b=a('<span class="jquery-console-prompt-label"></span>'),c=y.continuedPrompt?n:y.promptLabel;l.append(b.text(c).show()),b.html(b.html().replace(" ","&nbsp;")),m=a('<span class="jquery-console-prompt"></span>'),l.append(m),j.append(l),ia()}function B(a){return(a.keyCode==d.tab||192==a.keyCode)&&a.altKey}function C(a){if(0!=t.length){u+=a,u<0?u=t.length:u>t.length&&(u=0);p=0==u?q:t[u-1],c.historyPreserveColumn?p.length<o+1?o=p.length:0==o&&(o=p.length):o=p.length,ia()}}function D(){C(-1)}function E(){C(1)}function F(a){t.push(a),q=""}function G(){return o<p.length&&(p=p.substring(0,o)+p.substring(o+1),q=p,!0)}function H(){X(-1)&&(G(),ia())}function I(){G()&&ia()}function J(){for(;G();)ia()}function K(){y.promptText("")}function L(){j.children(".jquery-console-prompt-box, .jquery-console-message").slice(0,-1).remove(),y.report(" "),y.focus()}function M(){for(;o<p.length&&!ca(p[o]);)G(),ia();for(;o<p.length&&ca(p[o]);)G(),ia()}function N(){var a=p.split("\n"),b=a.slice(-1)[0],c=b.match(/^(\s*)/g)[0],d="\n"+c;p+=d,X(d.length),ia()}function O(){var a=p;if("function"==typeof c.commandValidate){var b=c.commandValidate(a);1==b||0==b?b&&R():U(b,"jquery-console-message-error")}else R()}function P(){var a=jQuery.fn.jquery.split("."),b=parseInt(a[0]),c=parseInt(a[1]);1==b&&c>6||b>1?j.prop({scrollTop:j.prop("scrollHeight")}):j.attr({scrollTop:j.attr("scrollHeight")})}function Q(){"function"==typeof c.cancelHandle&&c.cancelHandle()}function R(){if("function"==typeof c.commandHandle){S(),F(p);var a=p;y.continuedPrompt?r?r+="\n"+p:r=p:r=void 0,r&&(a=r);var b=c.commandHandle(a,function(a){U(a)});y.continuedPrompt&&!r&&(r=p),"boolean"==typeof b?b?U():U("Command failed.","jquery-console-message-error"):"string"==typeof b?U(b,"jquery-console-message-success"):"object"==typeof b&&b.length?U(b):y.continuedPrompt&&U()}}function S(){w=!1}function T(){w=!0}function U(b,c){if(o=-1,ia(),"string"==typeof b)W(b,c);else if(a.isArray(b))for(var d in b){var e=b[d];W(e.msg,e.className)}else j.append(b);A()}function V(a,b){var c=p;l.remove(),U(a,b),y.promptText(c)}function W(b,c){var d=a('<div class="jquery-console-message"></div>');c&&d.addClass(c),d.filledText(b).hide(),j.append(d),d.show()}function X(a){return o+a>=0&&o+a<=p.length&&(o+=a,!0)}function Y(){return!!X(1)&&(ia(),!0)}function Z(){return!!X(-1)&&(ia(),!0)}function $(){X(-o)&&ia()}function _(){X(p.length-o)&&ia()}function aa(){for(;o<p.length&&!ca(p[o])&&Y(););for(;o<p.length&&ca(p[o])&&Y(););}function ba(){for(;o-1>=0&&!ca(p[o-1])&&Z(););for(;o-1>=0&&ca(p[o-1])&&Z(););}function ca(a){if("string"==typeof a){var b=a.charCodeAt();return b>="A".charCodeAt()&&b<="Z".charCodeAt()||b>="a".charCodeAt()&&b<="z".charCodeAt()||b>="0".charCodeAt()&&b<="9".charCodeAt()}return!1}function da(){"function"==typeof c.completeHandle?ea():fa()}function ea(){if("function"==typeof c.completeHandle){var a=c.completeHandle(p),b=a.length;if(1===b)y.promptText(p+a[0]);else if(b>1&&c.cols){for(var d=p,e=0,f=0;f<b;f++)e=Math.max(e,a[f].length);e+=2;var g=Math.floor(c.cols/e),h="",i=0;for(f=0;f<b;f++){var j=a[f];h+=a[f];for(var k=j.length;k<e;k++)h+=" ";++i>=g&&(h+="\n",i=0)}U(h,"jquery-console-message-value"),y.promptText(d)}}}function fa(){"function"==typeof c.completeIssuer&&c.completeIssuer(p)}function ga(a,b){var d=b.length;if(1===d)y.promptText(a+b[0]);else if(d>1&&c.cols){for(var e=a,f=0,g=0;g<d;g++)f=Math.max(f,b[g].length);f+=2;var h=Math.floor(c.cols/f),i="",j=0;for(g=0;g<d;g++){var k=b[g];i+=b[g];for(var l=k.length;l<f;l++)i+=" ";++j>=h&&(i+="\n",j=0)}U(i,"jquery-console-message-value"),y.promptText(e)}}function ha(){}function ia(){var a=p,b="";if(o>0&&""==a)b=h;else if(o==p.length)b=ja(a)+h;else{var c=a.substring(0,o),d=a.substring(o,o+1);d&&(d='<span class="jquery-console-cursor">'+ja(d)+"</span>");var e=a.substring(o+1);b=ja(c)+d+ja(e)}m.html(b),P()}function ja(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/</g,"&lt;").replace(/ /g,"&nbsp;").replace(/\n/g,"<br />")}var d={37:Z,39:Y,38:D,40:E,8:H,46:I,35:_,36:$,13:O,18:ha,9:da},e={65:$,69:_,68:I,78:E,80:D,66:Z,70:Y,75:J,76:L,85:K};c.ctrlCodes&&a.extend(e,c.ctrlCodes);var l,m,f={70:aa,66:ba,68:M},g={13:N},h='<span class="jquery-console-cursor">&nbsp;</span>',i=a(this),j=a('<div class="jquery-console-inner"></div>'),k=a('<textarea autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" class="jquery-console-typer"></textarea>'),n=c&&c.continuedPromptLabel?c.continuedPromptLabel:"> ",o=0,p="",q="",r="",s=void 0===c.fadeOnReset||c.fadeOnReset,t=[],u=0,v=0,w=!0,y={};!function(){y.promptLabel=c&&c.promptLabel?c.promptLabel:"> ",i.append(j),j.append(k),k.css({position:"absolute",top:0,left:"-9999px"}),c.welcomeMessage&&W(c.welcomeMessage,"jquery-console-welcome"),A(),c.autofocus&&(j.addClass("jquery-console-focus"),k.focus(),setTimeout(function(){j.addClass("jquery-console-focus"),k.focus()},100)),y.inner=j,y.typer=k,y.scrollToBottom=P,y.report=V,y.showCompletion=ga,y.clearScreen=L}(),y.reset=function(){var b="undefined"!=typeof c.welcomeMessage,d=function(){j.find("div").each(function(){b?b=!1:a(this).remove()})};s?j.parent().fadeOut(function(){d(),A(),j.parent().fadeIn(z)}):(d(),A(),z())};var z=function(){j.addClass("jquery-console-focus"),k.focus()};return y.focus=function(){z()},y.notice=function(b,c){var d=a('<div class="notice"></div>').append(a("<div></div>").text(b)).css({visibility:"hidden"});i.append(d);var e=!0;if("fadeout"==c)setTimeout(function(){d.fadeOut(function(){d.remove()})},4e3);else if("prompt"==c){var f=a('<br/><div class="action"><a href="javascript:">OK</a><div class="clear"></div></div>');d.append(f),e=!1,f.click(function(){d.fadeOut(function(){d.remove(),j.css({opacity:1})})})}var g=d.height();return d.css({height:"0px",visibility:"visible"}).animate({height:g+"px"},function(){e||j.css({opacity:.5})}),d.css("cursor","default"),d},i.click(function(){return!window.getSelection().toString()&&(j.addClass("jquery-console-focus"),j.removeClass("jquery-console-nofocus"),b?k.focusWithoutScrolling():k.css("position","fixed").focus(),P(),!1)}),k.blur(function(){j.removeClass("jquery-console-focus"),j.addClass("jquery-console-nofocus")}),k.bind("paste",function(a){k.val(""),setTimeout(function(){k.consoleInsert(k.val()),k.val("")},0)}),k.keydown(function(a){v=0;var b=a.keyCode;if(a.ctrlKey&&67==b)return v=b,Q(),!1;if(w){if(a.shiftKey&&b in g)return v=b,g[b](),!1;if(a.altKey&&b in f)return v=b,f[b](),!1;if(a.ctrlKey&&b in e)return v=b,e[b](),!1;if(b in d)return v=b,d[b](),!1}}),k.keypress(function(a){var d=a.keyCode||a.which;if(B(a))return!1;if((a.ctrlKey||a.metaKey)&&"v"==String.fromCharCode(d).toLowerCase())return!0;if(w&&v!=d&&d>=32){if(v)return!1;("undefined"==typeof c.charInsertTrigger||"function"==typeof c.charInsertTrigger&&c.charInsertTrigger(d,p))&&k.consoleInsert(d)}return!b&&void 0}),k.consoleInsert=function(a){var b="number"==typeof a?String.fromCharCode(a):a,c=p.substring(0,o),d=p.substring(o);p=c+b+d,X(b.length),q=p,ia()},y.promptText=function(a){return"string"==typeof a&&(p=a,o=p.length,ia()),p},y},a.fn.filledText=function(b){return a(this).text(b),a(this).html(a(this).html().replace(/\t/g,"&nbsp;&nbsp;").replace(/\n/g,"<br/>")),this},a.fn.focusWithoutScrolling=function(){var b=window.scrollX,c=window.scrollY;a(this).focus(),window.scrollTo(b,c)}}(jQuery);